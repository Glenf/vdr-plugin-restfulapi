<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>RESTFULAPI Documentation</title>

<style type="text/css">
html, body {
    background-color: white;
}
.blurb {
    font-style: italic;
    font-weight: bold;
    text-align: center;
}
.center {
    text-align: center;
}
.code {
    background-color: #F0F0F0;
}
.modified {
    background-color: #FFDDDD;
}
</style>
</head>
<body>

<div class="center">
<h1>RESTFULAPI-Plugin for VDR</h1><br />
<b>Version 0.0.1 (still in development)</b><br />
Copyright &copy; 2011 yavdr-Team, Michael Eiler<br /><br />
Organization/Community: <a href="mailto:team@yavdr.org">team@yavdr.org</a><br />
Developer: <a href="mailto:eiler.mike@gmail.com">eiler.mike@gmail.com</a> or <a href="mailto:aelo@yavdr.org">aelo@yavdr.org</a><br />
<a href="http://www.yavdr.org">www.yavdr.org</a><br />
<a href="http://github.com/yavdr/vdr-plugin-restfulapi">www.github.com/yavdr/vdr-plugin-restfulapi</a><br />
</div>
<br />
<hr />

<h1>Table Of Contents</h1>
<ul>
<li><a href="#Preface">Preface</a>
<li><a href="#Requirements">Requirements</a>
<li><a href="#Configuration">Configuration</a>
<li><a href="#Channels">Channels</a>
<ul><li><a href="#ChannelGroups">Groups</a>
    <li><a href="#ChannelImages">Images / Channel-Logos</a></ul>
<li><a href="#Events">Events / EPG</a>
<ul><li><a href="#EventImages">Images</a></ul>
<li><a href="#Recordings">Recordings</a>
<li><a href="#Remote">Remote</a>
<li><a href="#Timers">Timers</a>
<ul><li><a href="#ReadingTimers">Reading Timers</a>
    <li><a href="#CreatingTimers">Creating Timers</a>
    <li><a href="#UpdatingTimers">Updating Timers</a>
    <li><a href="#DeletingTimers">Deleting Timers</a></ul>
</ul>

<hr />
<h1 class="center"><a name="Preface">Preface</a></h1>
<hr />
<br />

This plugin has been developed to offer a modern API for other developers to communicate with the VDR. <br />
The plugin supports the following outputs formats: xml, json and html.<br />
<br />
It would not exist without the help of the following people:<br />

<ul>
<li>Klaus Schmidinger: Of course because of the VDR itself. Thank you also for the nice and clean layout for the API-Documentation which I "borrowed" from your PLUGINS.html.
<li>Gerald Dachs: Thank you for the intial idea and the initial jsonapi-Plugin.
<li>Volker Richert: Thank you for fixing the UTF8-Support.
<li>Tommi MÃ¤kitalo: Thank you for implementing the Regex-Support in cxxtools which allows RESTful web services.
<li>The developers of the live and vnsisserver Plugins which helper me to lear a lot about the API of VDR.
<li>Daniel Kuschny: Thank you for fixing my broken regular expressions. Will pay you a beer! :-)
</ul>


<hr />
<h1 class="center"><a name="Requirements">Requirements</a></h1>
<hr />
<br />

Someone who wants to install the plugin on his/her VDR needs following applications and libraries:
<br />
<ul>
<li>VDR 1.7.18 - There won't be support for VDR 1.6!
<li>libcxxtools Rev. &gt;= 1231, which is available as package for Ubuntu in the yavdr-PPA's
</ul>

Someone who wants to develop an application which uses this API:
<br/>
<ul>
<li>XML or JSON Parser (Depends on which format you want to use! - You can also use the html-format, but that one is more a proof for the restful concept and does not show all information!)
<li>URL Decoder
</ul>

<hr />
<h1 class="center"><a name="Configuration">Configuration</a></h1>
<hr />
<br />

Create a new file called plugin.restfulapi.conf in /etc/vdr/plugins/.<br />
<br />
<div class="code"><code>
#
# Command line parameters for vdr-plugin-restfulapi
#

--port=8002
--ip=0.0.0.0
--epgimages=/var/cache/vdr/epgimages
--channellogos=/usr/share/vdr/channel-logos
</code></div>
<br />
If you don't use a DEBIAN based distribution, you can also use the following configuration method.<br />
Simply create a file called restfulapi.conf in your plugin-configuration-folder. (f.e.: /var/lib/vdr/plugins/)<br />
<br />
<div class="code"><code>
# This is an example configuration file for the restfulapi-plugin.<br />
<br />
port = 8002<br />
ip = 0.0.0.0<br />
epgimages = /var/cache/vdr/epgimages<br />
channellogos = /usr/share/vdr/channel-logos
</code></div>

<br />
<hr />
<h1 class="center"><a name="Channels">Channels</a></h1>
<hr />
<br />

This service returns a list of channels.<br />
<br />

<b>The Request:</b>
<br />
<br />
Method: <b>GET</b><br />
<br />
Examples: <br/>
<br />
<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/channels/.&lt;format&gt;<br />
GET http://&lt;ip&gt;:&lt;port&gt;/channels/&lt;channelid&gt;.&lt;format&gt;<br />
GET http://&lt;ip&gt;:&lt;port&gt;/channels/.&lt;format&gt;?start=&lt;int&gt;&amp;limit=&lt;int&gt;<br />
</code></div>
<br />
<br />
<b>Description of the Parameters:</b>
<br />
<br />

<ul>
<li>&lt;format&gt; - The requested format: json, xml or html.
<li>&lt;channelid&gt; - Id of the requested channel.
<li>start, limit - These values are used to control the whole list. Start ist the first element you want to retrieve. Limit...
</ul>

<br />
<br />

<b>Example Result:</b>
<br />
<br />

<div class="code"><code>
GET http://127.0.0.1:8002/channels.xml?start=0&amp;limit=1<br /><br />
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;<br />
&lt;channels xmlns="http://www.domain.org/restfulapi/2011/channels-xml"&gt;<br />
 &lt;channel&gt;<br />
  &lt;param name="name"&lt;ORF1 HD&lt;/param&gt;<br />
  &lt;param name="number"&gt;1&lt;/param&gt;<br />
  &lt;param name="channel_id"&gt;C-71-71-61920&lt;/param&lt;<br />
  &lt;param name="image"&gt;true&lt;/param&gt;<br />
  &lt;param name="group"&gt;hd&lt;/param&gt;<br />
  &lt;param name="transponder"&gt;330&lt;/param&gt;<br />
  &lt;param name="stream"&gt;C-71-71-61920.ts&lt;/param&gt;<br />
  &lt;param name="is_atsc"&gt;false&lt;/param&gt;<br />
  &lt;param name="is_cable"&gt;true&lt;/param&gt;<br />
  &lt;param name="is_sat"&gt;false&lt;/param&gt;<br />
  &lt;param name="is_terr"&gt;false&lt;/param&gt;<br />
 &lt;/channel&gt;<br />
 &lt;count&gt;1&lt;/count&gt;<br />
 &lt;total&gt;259&lt;/total&gt;<br />
&lt;/channels&gt;
</code></div>
<br />

<div class="code"><code>
GET http://127.0.0.1:8002/channels.json?start=0&amp;limit=1<br /><br />
{ "channels": [<br />
{<br />
"name":"ORF1 HD",<br />
"number":1,<br />
"channel_id":"C-71-71-61920",<br />
"image":"true",<br />
"group":"hd",<br />
"transponder":330,<br />
"stream":"C-71-71-61920.ts",<br />
"is_atsc":false,<br />
"is_cable":true,<br />
"is_terr":false,<br />
"is_sat":false<br />
}],<br />
"count":1,<br />
"total":259<br />
}
</code></div>

<h2><a name="ChannelGroups">Groups</a></h2>
<br />

This service will return a list containing all channel groups.<br />
<br />
<b>The Request:</b><br />
<br />

Method: <b>GET</b><br />
<br />
Examples: <br />
<br />
<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/channels/groups<br />
GET http://&lt;ip&gt;:&lt;port&gt;/channels/groups?start=&lt;int&gt;&amp;limit=&lt;int&gt;<br />
GET http://&lt;ip&gt;:&lt;port&gt;/channels.&lt;format&gt;?group=&lt;group&gt;
</code></div>
<br />
<br />

<b>Description of the Parameters</b></br>
<br />
<ul>
 <li>&lt;group&gt; - returns the channels of the requested group
</ul>
<br />
<br />

<b>Example Result:</b><br />
<br />

<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/channels/groups?start=0&amp;limit=3<br />
<br />
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;<br />
&lt;groups xmlns="http://www.domain.org/restfulapi/2011/groups-xml"&gt;<br />
 &lt;group&gt;hd&lt;/group&gt;<br />
 &lt;group&gt;main&lt;/group&gt;<br />
 &lt;group&gt;stuff&lt;/group&gt;<br />
 &lt;count&gt;3&lt;/count&gt;<br />
 &lt;total&gt;3&lt;/total&gt;<br />
&lt;/groups&gt;
</code></div>
<br />


<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/channels/groups?start=0&amp;limit=3<br />
<br />
{<br />
"groups":<br />
[<br />
"hd",<br />
"main",<br />
"stuff"<br />
],<br />
"count":3,<br />
"total":3<br (>
}
</code></div>

<h2><a name="ChannelImages">Images / Channel-Logos</a></h2>
<br />

This service returns the requested channel-logo.<br />
<br />    XML or JSON Parser (Depends on which format you want to use!)
    URL Decoder 
Method: <b>GET</b><br />
<br />
Examples: <br />
<br />
<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/channels/image/&lt;channelid&gt;
</code></div>
<br />
<br />


<hr />
<h1 class="center"><a name="Events">Events / EPG</a></h1>
<hr />
<br />

This service returns the epg information.<br />
<br />
Method: <b>GET</b><br />
<br />
Examples: <br />
<br />
<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/events/&lt;channelid&gt;/&lt;timespan&gt;.&lt;format&gt;<br />
GET http://&lt;ip&gt;:&lt;port&gt;/events/&lt;channelid&gt;/&lt;timespan&gt;/&lt;from&gt;.&lt;format&gt;<br />
GET http://&lt;ip&gt;:&lt;port&gt;/events/&lt;channelid&gt;/&lt;timespan&gt;/&lt;from&gt;.&lt;format&gt;?start=&lt;int&gt;&amp;limit=&lt;int&gt;
</code></div>
<br />
<br />
<b>Description of the Parameters:</b><br />
<br />
<ul>
 <li>&lt;format&gt; - The requested format: json, xml or html.
 <li>&lt;channelid&gt; - id of the channel
 <li>&lt;timespan&gt; - the timespan from which you want to know the event-details, if set to 0 - all events in the future will be returned
 <li>&lt;from&gt; - (optional) time in the future when the requested events should end/start (default-value: now)
</ul>

<br />
<br />
<b>Example Result:</b><br />
<br />

<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/events/C-1-1011-11110/3600.xml?start=0&amp;limit=1<br />
<br />
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;<br />
&lt;events xmlns="http://www.domain.org/restfulapi/2011/events-xml"&gt;<br />
 &lt;event&gt;<br />
  &lt;param name="id"&gt;51514&lt;/param&gt;<br />
  &lt;param name="title"&gt;Eine Serie&lt;/param&gt;<br />
  &lt;param name="short_text"&gt;Der Episodentitel&lt;/param&gt;<br />
  &lt;param name="description"&gt;Die Beschreibung&lt;/param&gt;<br />
  &lt;param name="start_time"&gt;1308845100&lt;/param&gt;<br />
  &lt;param name="duration"&gt;3300&lt;/param&gt;<br />
  &lt;param name="images"&gt;1&lt;/param&gt;<br />
 &lt;/event&gt;<br />
 &lt;count&gt;1&lt;/count&gt;<br />
 &lt;total&gt;236&lt;/total&gt;<br />
&lt;/events&gt;
</code></div>
<br />
<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/events/C-1-1011-11110/3600.json?start=0&amp;limit=1<br />
<br />
{"events":[{<br />
"id":51514,<br />
"title":"Eine Serie",<br />
"short_text":"Der Episodentitel",<br />
"description":"Die Beschreibung",<br />
"start_time":1308845100,<br />
"duration":3300, <br />
"images":3,<br />
"count":1,<br />
"total":236}
</code></div>
<br />

<h2><a name="EventImages">Images</a></h2>
<br />

This service returns the requested epg image.<br />
<br />
Method: <b>GET</b><br />
<br />
Examples: <br />
<br />
<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/events/image/&lt;eventid&gt;/&lt;imagenumber&gt;
</code></div>
<br />
<br />

<b>Description of the Parameters:</b><br />
<br />

<ul>
<li>&lt;eventid&gt; - Id of the event
<li>&lt;imagenumber&gt; - the number of the image, in the above mentioned examples it would be 0,1 or 2
</ul>

<hr />
<h1 class="center"><a name="Recordings">Recordings</a></h1>
<hr />
<br />


This service can delete recordings and can also return all the recordings as a list.<br />
<br />

<b>The Request:</b>
<br />
<br />
Method: <b>GET</b><br />
<br />
Examples: <br/>
<br />
<div class="code"><code>
GET http://&lt;ip&gt;:&lt;port&gt;/recordings/.&lt;format&gt;<br />
DELETE http://&lt;ip&gt;:&lt;port&gt;/recordings/&lt;number&gt;

</code></div>
<br />
<br />
<b>Description of the Parameters:</b>
<br />
<br />

<ul>
<li>&lt;format&gt; - The requested format: json, xml or html.
<li>&lt;number&gt; - The number of the recording which you want to delete. (The first recordings has the number 0.)
<li>start, limit - These values are used to control the whole list. Start ist the first element you want to retrieve. Limit...
</ul>

<br />
<br />

<b>Example Result:</b>
<br />
<br />

<div class="code"><code>
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;<br />
&lt;recordings xmlns="http://www.domain.org/restfulapi/2011/recordings-xml"&gt;<br />
 &lt;recording&gt;<br />
  &lt;param name="name"&gt;Asterix in Amerika&lt;/param&gt;<br />
  &lt;param name="filename"&gt;/var/lib/video.00/Asterix_in_Amerika/2011-06-19.12.40.1-0.rec&lt;/param&gt;<br />
  &lt;param name="is_new"&gt;false&lt;/param&gt;<br />
  &lt;param name="is_edited"&gt;false&lt;/param&gt;<br />
  &lt;param name="is_pes_recording"&gt;false&lt;/param&gt;<br />
  &lt;param name="duration"&gt;-1&lt;/param&gt;<br />
  &lt;param name="event_title"&gt;Asterix in Amerika&lt;/param&gt;<br />
  &lt;param name="event_short_text"&gt;&lt;/param&gt;<br />
  &lt;param name="event_description"&gt;(Zeichentrickfilm, DEU 1994)&lt;/param&gt;<br />
  &lt;param name="event_start_time"&gt;1308480705&lt;/param&gt;<br />
  &lt;param name="event_duration"&gt;4611&lt;/param&gt;<br />
 &lt;/recording&gt;<br />
 &lt;count&gt;2&lt;/count&gt;&lt;total&gt;2&lt;/total&gt;<br />
&lt;/recordings&gt;
</code></div>
<br />

<div class="code"><code>
{"recordings":[{<br />
"name":"Asterix in Amerika",<br />
"file_name":"\/var\/lib\/video.00\/Asterix_in_Amerika\/2011-06-19.12.40.1-0.rec",<br />
"is_new":false,<br />
"is_edited":false,<br />
"is_pes_recording":false,<br />
"duration":-1,<br />
"event_title":"Asterix in Amerika",<br />
"event_short_text":"",<br />
"event_description":"(Zeichentrickfilm, DEU 1994)",<br />
"event_start_time":1308480705,<br />
"event_duration":4611<br />
}],"count":1,"total":2}
</code></div>
<br />

<hr />
<h1 class="center"><a name="Remote">Remote</a></h1>
<hr />
<br />

This service retrieves remote commands and sends them to VDR:<br />
<br />
<b>Syntax:</b><br />
<br />
<div class="code"><code>
POST http://&lt;ip&gt;:&lt;port&gt;/remote/&lt;key&gt;<br />
POST http://&lt;ip&gt;:&lt;port&gt;/remot/switch/&lt;channelid&gt;
</code></div>
<br />
They parameter &lt;key&gt; can be set to the following remote control commands:<br /><br />
Up, Down, Menu, Ok, Back, Left, Right, Red, Green, Yellow, Blue, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, Info, Play, Pause, Stop, Record, FastFwd, FastRew, Next, Prev, Power, ChanUp, ChanDn, ChanPrev, VolUp, VolDn, Mute, Audio, Subtitles, Schedule, Channels, Timers, Recordings, Setup, Commands, User0, User1, User2, User3, User4, User5, User6, User7, User8, User9, None, Kbd<br />
<br />
The second address allows to directly switch to a specific channel.

<br />
<br />

<hr />
<h1 class="center"><a name="Timers">Timers</a></h1>
<hr />
<br />

<h2><a name="ReadingTimers">Reading Timers</a></h2>
<br />

<h2><a name="CreatingTimers">Creating Timers</a></h2>
<br />

<h2><a name="UpdatingTimers">Updating Timers</a></h2>
<br />

<h2><a name="DeletingTimers">Deleting Timers</a></h2>
<br />
</body>
</html>
